{"version":3,"sources":["../src/utilities/description.ts","../src/utilities/elements.ts","../src/utilities/index.ts","../src/enhancements/ImageDetails/index.ts","../src/enhancements/ImageOverlay/draggable.ts","../src/enhancements/ImageOverlay/index.ts","../src/enhancements/ImageModal/index.ts","../src/index.ts","image-overlay/index.ts"],"names":[],"mappings":"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","file":"image-overlay.2b845640.js","sourceRoot":"../site","sourcesContent":["const omitTags = (...tagNames: string[]) => (n: Node): boolean => {\n\tif (n instanceof HTMLElement) {\n\t\treturn !tagNames.some((tagName) => tagName.toUpperCase() === n.tagName.toUpperCase());\n\t}\n\treturn true;\n};\n\ntype NodeFilter = (n: Node) => boolean;\n\nconst filterNode = <T extends Node = HTMLElement>(\n\tnode: T | null,\n\tfilters: NodeFilter[],\n): T | null => ((node && filters.some((test) => test(node))) ? node : null);\n\n/**\n * Fetch an element from a given url. If the URL is a whole document, the entire\n * body will be returned inside a `DocumentFragment`. Returns `null` if nothing\n * is found.\n */\nexport const fetchElement = async (\n\turl: string,\n\tinit?: Parameters<typeof fetch>[1],\n\tfilters: NodeFilter[] = [\n\t\tomitTags('script', 'style'),\n\t],\n): Promise<HTMLElement | DocumentFragment | null> => {\n\tconst req = new Request(url);\n\tconst { hash, origin, pathname } = new URL(req.url);\n\tconst currentPage = window.location.origin + window.location.pathname;\n\n\t// same-page reference\n\tif ((origin + pathname) === currentPage) {\n\t\treturn filterNode<HTMLElement>(document.querySelector(hash), filters);\n\t}\n\n\t// reference to another page\n\tconst res = await fetch(req, init);\n\tif (res.status === 200) {\n\t\tconst html = await res.text();\n\n\t\tconst parser = new DOMParser();\n\t\tconst doc = parser.parseFromString(html, 'text/html');\n\n\t\t// a fragment on another page\n\t\tif (hash) {\n\t\t\treturn filterNode<HTMLElement>(document.querySelector(hash), filters);\n\t\t}\n\n\t\t// the body doesn't have any contents\n\t\tif (doc.body.firstChild === null) return null;\n\n\t\tconst contents = new DocumentFragment();\n\t\tArray.from(doc.body.childNodes).forEach((node) => {\n\t\t\tif (filters.some((test) => test(node))) {\n\t\t\t\tcontents.append(node);\n\t\t\t}\n\t\t});\n\t\treturn contents;\n\t}\n\n\treturn null;\n};\n\n/** All of the HTML attributes that can be used to reference a description. */\nexport enum DescriptionAttribute {\n\tARIA_DETAILS = 'aria-details',\n\tARIA_DESCRIBEDBY = 'aria-describedby',\n\tLONGDESC = 'longdesc',\n}\n\nexport interface Description {\n\tattr: DescriptionAttribute | null;\n\tvalue: HTMLElement | null;\n}\n\nexport const getDescriptionByAttr = async (\n\tel: HTMLElement,\n\tattr: DescriptionAttribute,\n): Promise<HTMLElement | null> => {\n\tconst attrValue = el.getAttribute(attr);\n\tif (!el.hasAttribute(attr) || !attrValue) return null;\n\n\t// longdesc: retrieve the description from a separate document\n\tif (attr === DescriptionAttribute.LONGDESC) {\n\t\tconst contents = await fetchElement(attrValue);\n\t\tif (contents instanceof DocumentFragment) {\n\t\t\tconst desc = document.createElement('div');\n\t\t\tdesc.append(contents);\n\t\t\treturn desc;\n\t\t}\n\t\treturn contents;\n\t}\n\n\tconst ref = document.getElementById(attrValue);\n\tif (ref) return ref.cloneNode(true) as HTMLElement;\n\treturn null;\n};\n\n\n/**\n * Get the image's long description.\n * Look for description attributes on the image and return the value of the\n * description. Attribute preference is `aria-details` > `longdesc` >\n * `aria-describedby`.\n */\nexport const getDescription = async (el: HTMLElement): Promise<Description[]> => Promise.all(\n\tObject.values(DescriptionAttribute)\n\t\t.filter((attr) => el.hasAttribute(attr))\n\t\t.map(async (attr) => ({\n\t\t\tattr,\n\t\t\tvalue: await getDescriptionByAttr(el, attr),\n\t\t})),\n);\n","export interface SVGIcon {\n\td: string;\n\tviewBox: string;\n\tsource?: string;\n}\n\nconst materialViewBox = '0 0 24 24';\n\nexport const icons: Record<string, SVGIcon> = {\n\tdetails: {\n\t\td: 'M3 4l9 16 9-16H3zm3.38 2h11.25L12 16 6.38 6z',\n\t\tviewBox: materialViewBox,\n\t\tsource: 'https://material.io/resources/icons/?icon=details&style=baseline',\n\t},\n\tclose: {\n\t\td: 'M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z',\n\t\tviewBox: materialViewBox,\n\t\tsource: 'https://material.io/resources/icons/?icon=close&style=baseline',\n\t},\n};\n\ninterface IconOptions {\n\tlabel?: string;\n\tclassName?: string;\n}\n\nconst SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n\nexport const createIcon = (\n\t{ viewBox, d, source }: SVGIcon,\n\t{ label, className }: IconOptions = {},\n): SVGSVGElement => {\n\tconst attributes: [string, string][] = [\n\t\t['xmlns', SVG_NAMESPACE],\n\t\t['focusable', 'false'],\n\t\t['role', 'img'],\n\t\t['viewBox', viewBox],\n\t];\n\tattributes.push((label) ? ['aria-label', label] : ['aria-hidden', 'true']);\n\tif (className) attributes.push(['class', className]);\n\n\tconst svg = document.createElementNS(SVG_NAMESPACE, 'svg');\n\tattributes.forEach((attr) => svg.setAttribute(...attr));\n\n\tif (source) svg.append(document.createComment(source));\n\n\tconst path = document.createElementNS(SVG_NAMESPACE, 'path');\n\tpath.setAttribute('fill', 'currentColor');\n\tpath.setAttribute('d', d);\n\n\tsvg.append(path);\n\n\treturn svg;\n};\n\nexport const focusableSelectors = [\n\t'[contentEditable=true]:not([tabindex=\"-1\"])',\n\t'[tabindex]:not([tabindex=\"-1\"])',\n\t'a[href]:not([tabindex=\"-1\"])',\n\t'button:not([disabled]):not([tabindex=\"-1\"])',\n\t'dialog',\n\t'embed:not([tabindex=\"-1\"])',\n\t'iframe:not([tabindex=\"-1\"])',\n\t'input:not([disabled]):not([tabindex=\"-1\"])',\n\t'map[name] area[href]:not([tabindex=\"-1\"])',\n\t'object:not([tabindex=\"-1\"])',\n\t'select:not([disabled]):not([tabindex=\"-1\"])',\n\t'summary:not([tabindex=\"-1\"])',\n\t'textarea:not([disabled]):not([tabindex=\"-1\"])',\n];\n\nexport const getFocusable = (\n\tel: HTMLElement | Document | ShadowRoot = document,\n): NodeListOf<HTMLElement> => el.querySelectorAll(focusableSelectors.join(','));\n\nexport const appendContent = (to: HTMLElement, ...contents: (string | Node)[]): void => {\n\tcontents.forEach((content) => {\n\t\tif (typeof content === 'string') {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.innerHTML = content;\n\t\t\tto.append(div.firstChild as ChildNode);\n\t\t} else {\n\t\t\tto.append(content);\n\t\t}\n\t});\n};\n","export * from './description';\nexport * from './elements';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport const noop = (): void => {};\n\nconst styleString = (\n\tstyle: Record<string, string | null>,\n): string => Object.keys(style).reduce((a, attr) => {\n\tconst val = style[attr];\n\treturn (val) ? `${a} ${attr}: ${val};` : a;\n}, '').trim();\n\nexport const setStyle = (el: HTMLElement, style: Parameters<typeof styleString>[0]): void => {\n\tel.setAttribute('style', styleString(style));\n};\n\nexport const srOnly = (el: HTMLElement): void => setStyle(el, {\n\tposition: 'absolute',\n\twidth: '1px',\n\theight: '1px',\n\tpadding: '0',\n\tmargin: '-1px',\n\toverflow: 'hidden',\n\tclip: 'rect(0, 0, 0, 0)',\n\twhiteSpace: 'nowrap',\n\tborder: '0',\n});\n","import {\n\tDescriptionAttribute,\n\tDescription,\n\tgetDescription,\n\tappendContent,\n\tsrOnly,\n\tnoop,\n} from '../../utilities';\n\nexport interface ImageDetailsOptions {\n\t/**\n\t * Indicates that the image's `alt` contents should be copied to the\n\t * <details> as its first child. This will be `aria-hidden` so that users\n\t * who read it on the image don't have to read it again.\n\t */\n\taddAltText?: boolean;\n\t/**\n\t * Where the `<details>` should be placed relative to the image in the DOM.\n\t *\n\t * * `after-image` indicates `img + details`.\n\t * * `before-image` indicates `details + img`.\n\t */\n\tdetailsPlacement?: 'after-image' | 'before-image';\n\t/**\n\t * Indicates whether the summary's textual content should be visible. If\n\t * `false`, the summary text will be set as both the `aria-label` and `title`.\n\t */\n\tdisplaySummaryText?: boolean;\n\t/**\n\t * Indicates that the `Escape` key should close the `<details>`. Note that\n\t * `Escape` will always close the `details` if focus is on the `<summary>`.\n\t */\n\tcloseOnEscape?: boolean;\n\t/**\n\t * HTML string heading for the alt text section of the `<details>`. Only used\n\t * if `addAltText` is `true`. Default is `<h2>Alt Text</h2>`.\n\t */\n\taltSectionHeading?: () => string | HTMLElement;\n\t/**\n\t * HTML string heading for the long description section of the `<details>`.\n\t * Default is `<h2>Image Description</h2>`.\n\t */\n\tdescriptionHeading?: () => string | HTMLElement;\n\t/**\n\t * A custom `summary::marker` element. If included, it will be added as the\n\t * first child of the `<summary>` and will be accessible on the instance as\n\t * `ImageDetailsInstance.marker`.\n\t *\n\t * To specify a different element on open and close, pass an object with\n\t * `open` and `closed` values.\n\t */\n\tsummaryMarker?: () => string | HTMLElement | SVGSVGElement | null;\n\t/** Text to display in the <summary> element. */\n\tsummaryText?: (\n\t\t/** Indicates whether a long description exists. */\n\t\thasDescription: boolean\n\t) => string;\n\t/**\n\t * The class for the `<div>` that wraps the `<img> + <details>`. This will\n\t * also be used as the \"block\" name in the BEM class naming for child elements.\n\t */\n\tblockName?: string;\n\tonGetDescription?: (descriptions: Description[]) => void;\n}\n\nconst ImageDetailsInstances = new Set<ImageDetails>();\n\nexport class ImageDetails {\n\tpublic description?: string | Node | null;\n\tpublic container: HTMLElement;\n\tpublic details: HTMLDetailsElement;\n\tpublic summary!: HTMLElement;\n\tpublic marker!: HTMLSpanElement;\n\tpublic contents!: HTMLDivElement;\n\tpublic descriptionSection: HTMLElement | null = null;\n\tpublic descriptionAttribute: DescriptionAttribute | null = null;\n\tprivate originalImage: HTMLImageElement;\n\tprivate originalDetails: HTMLDetailsElement | null = null;\n\tprivate descriptionAdded = false;\n\t// private hasAdjacentDetails = false;\n\t// private existingDetailsDescription = false;\n\n\tpublic static baseName = 'image-details';\n\tpublic static defaultOptions: Required<ImageDetailsOptions> = {\n\t\taddAltText: true,\n\t\tdetailsPlacement: 'after-image',\n\t\tdisplaySummaryText: true,\n\t\tcloseOnEscape: true,\n\t\taltSectionHeading: () => '<h2>Alt Text</h2>',\n\t\tdescriptionHeading: () => '<h2>Image Description</h2>',\n\t\tsummaryMarker: () => null,\n\t\tsummaryText: (hasDescription: boolean): string => {\n\t\t\tlet text = 'Description';\n\t\t\tif (!hasDescription) text += ' (only alt text)';\n\t\t\treturn text;\n\t\t},\n\n\t\tblockName: 'image-details',\n\n\t\tonGetDescription: noop,\n\t}\n\n\tprotected constructor(\n\t\tpublic image: HTMLImageElement,\n\t\tpublic options: Required<ImageDetailsOptions>,\n\t) {\n\t\tthis.originalImage = this.image.cloneNode(true) as HTMLImageElement;\n\n\t\tthis.image.classList.add(this.getClass('image'));\n\n\t\tthis.container = this.createContainer();\n\t\tthis.details = this.createDetails();\n\n\t\tthis.container.append(this.image, this.details);\n\n\t\tImageDetailsInstances.add(this);\n\t}\n\n\tpublic get hasDescription(): boolean {\n\t\treturn Object.values(DescriptionAttribute)\n\t\t\t.some((attr) => this.image.getAttribute(attr));\n\t}\n\n\tpublic async addDescription(description?: string | Node): Promise<void> {\n\t\tif (this.descriptionAdded) return;\n\t\tconst { descriptionHeading, onGetDescription = noop } = this.options;\n\n\t\tif (description) {\n\t\t\tthis.description = description;\n\t\t} else {\n\t\t\tconst descriptions = await getDescription(this.image);\n\t\t\tonGetDescription.call(this, descriptions);\n\t\t\tif (descriptions.length) {\n\t\t\t\tconst [{ attr, value }] = descriptions;\n\t\t\t\tthis.descriptionAttribute = attr;\n\t\t\t\tthis.description = value;\n\t\t\t}\n\t\t}\n\n\t\tif (this.description && this.descriptionSection) {\n\t\t\tappendContent(this.descriptionSection, descriptionHeading(), this.description);\n\t\t\tthis.descriptionAdded = true;\n\t\t}\n\t}\n\n\tpublic destroy(): this {\n\t\t(this.container.parentNode || document).insertBefore(this.originalImage, this.container);\n\t\tif (this.originalDetails) {\n\t\t\tconst { detailsPlacement } = this.options;\n\t\t\tconst refChild = (detailsPlacement === 'after-image')\n\t\t\t\t? this.originalImage.nextSibling\n\t\t\t\t: this.originalImage;\n\t\t\t(this.originalImage.parentNode || document).insertBefore(this.originalDetails, refChild);\n\t\t}\n\t\tthis.container.remove();\n\t\tImageDetailsInstances.delete(this);\n\t\treturn this;\n\t}\n\n\t// element constructors\n\n\tprivate createContainer(): HTMLElement {\n\t\tif (this.container) return this.container;\n\t\tconst { blockName } = this.options;\n\t\tconst { parentElement } = this.image;\n\t\tconst container = (\n\t\t\tparentElement instanceof HTMLElement && parentElement.classList.contains(blockName)\n\t\t) ? parentElement : document.createElement('div');\n\t\tcontainer.classList.add(blockName);\n\t\tif (container.contains(this.image)) return container;\n\n\t\t// append to the document\n\t\t(parentElement || document).insertBefore(container, this.image);\n\n\t\treturn container;\n\t}\n\n\tprivate createDetails(): HTMLDetailsElement {\n\t\tif (this.details) return this.details;\n\t\tconst { detailsPlacement } = this.options;\n\n\t\tlet details = document.createElement('details');\n\n\t\tconst detailsCandidate = (detailsPlacement === 'after-image')\n\t\t\t? this.image.nextElementSibling\n\t\t\t: this.image.previousElementSibling;\n\n\t\tif (detailsCandidate instanceof HTMLDetailsElement) {\n\t\t\t// `img + details` already exists so use it, storing a copy of the original\n\t\t\tthis.originalDetails = detailsCandidate.cloneNode(true) as HTMLDetailsElement;\n\t\t\tdetails = detailsCandidate;\n\t\t} else {\n\t\t\t// add the new details to the document\n\t\t\tconst refChild = (detailsPlacement === 'after-image')\n\t\t\t\t? this.image.nextSibling : this.image;\n\t\t\t(this.image.parentNode || document).insertBefore(details, refChild);\n\n\t\t\t// create the summary\n\t\t\tthis.summary = this.createSummary();\n\t\t\tdetails.prepend(this.summary);\n\n\t\t\t// create the summary marker\n\t\t\tthis.marker = this.createMarker();\n\t\t\tthis.summary.prepend(this.marker);\n\n\t\t\t// create the contents\n\t\t\tthis.contents = this.createContents();\n\t\t\tdetails.append(this.contents);\n\t\t}\n\n\t\tdetails.classList.add(this.getClass('details'));\n\n\t\treturn details;\n\t}\n\n\tprivate createSummary(): HTMLElement {\n\t\tconst { displaySummaryText, summaryText } = this.options;\n\n\t\tconst summary = document.createElement('summary');\n\t\tsummary.classList.add(this.getClass('summary'));\n\t\tconst text = summaryText(this.hasDescription);\n\t\tconst span = document.createElement('span');\n\t\tappendContent(span, text);\n\t\tif (!displaySummaryText) srOnly(span);\n\t\tsummary.append(span);\n\n\t\treturn summary;\n\t}\n\n\tprivate createMarker(): HTMLSpanElement {\n\t\tconst { summaryMarker } = this.options;\n\n\t\tconst innerMarker = summaryMarker();\n\t\tconst marker = document.createElement('span');\n\t\tmarker.classList.add(this.getClass('marker'));\n\t\tif (innerMarker) marker.append(innerMarker);\n\n\t\treturn marker;\n\t}\n\n\tprivate createContents(): HTMLDivElement {\n\t\tconst { addAltText } = this.options;\n\n\t\tconst contents = document.createElement('div');\n\t\tcontents.classList.add(this.getClass('contents'));\n\t\tif (addAltText) contents.append(this.createAltSection());\n\t\tcontents.append(this.createDescriptionSection());\n\n\t\treturn contents;\n\t}\n\n\tprivate createAltSection(): HTMLElement {\n\t\tconst { altSectionHeading } = this.options;\n\t\tconst section = document.createElement('section');\n\t\tsection.classList.add(this.getClass('alt'));\n\t\tsection.setAttribute('aria-hidden', 'true');\n\t\tappendContent(section, altSectionHeading(), `<p>${this.image.alt}</p>`);\n\t\treturn section;\n\t}\n\n\tprivate createDescriptionSection(): HTMLElement {\n\t\tconst section = document.createElement('section');\n\t\tsection.classList.add(this.getClass('desc'));\n\t\tthis.descriptionSection = section;\n\t\treturn section;\n\t}\n\n\tprivate getClass(element: string, asSelector = false): string {\n\t\tconst { blockName } = this.options;\n\t\tconst className = `${blockName}__${element}`;\n\t\tif (asSelector) return `.${className}`;\n\t\treturn className;\n\t}\n\n\tpublic static async enhance(\n\t\timage: HTMLImageElement,\n\t\toptions?: ImageDetailsOptions,\n\t): Promise<ImageDetails | null> {\n\t\tconst opts = { ...ImageDetails.defaultOptions, ...options };\n\t\tconst hasDesc = Object.values(DescriptionAttribute).some((attr) => image.getAttribute(attr));\n\t\tif (!hasDesc && !image.alt) return null;\n\t\tconst instance = new ImageDetails(image, opts);\n\t\tawait instance.addDescription();\n\t\treturn instance;\n\t}\n\n\tpublic static async enhanceAll(\n\t\t{ selector = 'img', ...options }: ImageDetailsOptions & { selector?: string } = {},\n\t): Promise<typeof ImageDetails.instances> {\n\t\tawait Promise.all(Array.from(document.querySelectorAll<HTMLImageElement>(selector))\n\t\t\t.map(async (el) => ImageDetails.enhance(el, options)));\n\t\treturn ImageDetails.instances;\n\t}\n\n\tpublic static get instances(): ImageDetails[] {\n\t\treturn Array.from(ImageDetailsInstances);\n\t}\n}\n","import { getFocusable, setStyle, noop } from '../../utilities';\n\nexport interface DraggablePosition {\n\ttop: number | null;\n\tleft: number | null;\n}\n\ninterface DraggableOptions {\n\t/**\n\t * A list of elements that will not initiate the `grab` action, which begins\n\t * the element dragging.\n\t */\n\texcludedElements?: HTMLElement[] | ((draggableElement: HTMLElement) => HTMLElement[]);\n\t/**\n\t * Indicates that all focusable/interactive elements inside the draggable\n\t * element should not initiate dragging. Default is `true`.\n\t */\n\texcludeFocusable?: boolean;\n\n\tonDrag?: () => void;\n\tonGrab?: () => void;\n\tonMove?: () => void;\n\tonRelease?: () => void;\n}\n\nexport class Draggable {\n\tpublic options: Required<DraggableOptions>;\n\tprivate moveX = 0;\n\tprivate moveY = 0;\n\tprivate canGrab = false;\n\tprivate grabbed = false;\n\n\tprotected constructor(\n\t\tpublic el: HTMLElement,\n\t\tpublic keyboardEl: HTMLElement | null,\n\t\toptions?: Partial<DraggableOptions>,\n\t) {\n\t\tthis.options = { ...Draggable.defaultOptions, ...options };\n\n\t\tthis.el.addEventListener('pointerdown', this.grab);\n\t\tthis.el.addEventListener('pointerleave', this.release);\n\t\tthis.el.addEventListener('pointermove', this.pointermove);\n\t\tthis.el.addEventListener('pointerup', this.release);\n\n\t\tif (this.keyboardEl) {\n\t\t\tthis.keyboardEl.addEventListener('keydown', this.moveWithKeyboard);\n\t\t}\n\t}\n\n\tpublic move(x: number, y: number): void {\n\t\tconst { top, left } = this.pos;\n\t\tif (top !== null && left !== null) {\n\t\t\tsetStyle(this.el, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\tleft: `${left + x}px`,\n\t\t\t\ttop: `${top + y}px`,\n\t\t\t});\n\t\t}\n\t\tthis.options.onMove();\n\t}\n\n\tpublic resetPosition(): void {\n\t\tsetStyle(this.el, {\n\t\t\tposition: null,\n\t\t\ttop: null,\n\t\t\tleft: null,\n\t\t});\n\t}\n\n\tpublic get pos(): DraggablePosition {\n\t\tconst { top = '0', left = '0' } = window.getComputedStyle(this.el);\n\t\treturn {\n\t\t\ttop: (top === 'auto') ? null : parseInt(top, 10),\n\t\t\tleft: (top === 'auto') ? null : parseInt(left, 10),\n\t\t};\n\t}\n\n\tprivate grab = (e: MouseEvent): void => {\n\t\tif (!this.canGrab) return;\n\n\t\tthis.moveX = e.clientX;\n\t\tthis.moveY = e.clientY;\n\t\tthis.grabbed = true;\n\t\tthis.options.onGrab();\n\t};\n\n\tprivate release = (): void => {\n\t\tthis.moveX = 0;\n\t\tthis.moveY = 0;\n\t\tthis.grabbed = false;\n\t\tthis.options.onRelease();\n\t};\n\n\tprivate drag = ({ clientX, clientY }: MouseEvent): void => {\n\t\tthis.move(clientX - this.moveX, clientY - this.moveY);\n\t\tthis.moveX = clientX;\n\t\tthis.moveY = clientY;\n\t\tthis.options.onDrag();\n\t}\n\n\tprivate pointermove = (e: MouseEvent): void => {\n\t\tif (this.grabbed) {\n\t\t\tthis.drag(e);\n\t\t} else {\n\t\t\tconst { excludedElements, excludeFocusable } = this.options;\n\n\t\t\tconst excluded = [\n\t\t\t\t...((typeof excludedElements === 'function') ? excludedElements(this.el) : excludedElements),\n\t\t\t\t...((excludeFocusable) ? Array.from(getFocusable(this.el)) : []),\n\t\t\t].filter((el) => el && e.composedPath().includes(el));\n\n\t\t\tthis.canGrab = !excluded.some(Boolean);\n\t\t}\n\t};\n\n\tprivate moveWithKeyboard = (e: KeyboardEvent): void => {\n\t\tconst mod = e.shiftKey ? 20 : 1;\n\t\tconst step = mod * 1;\n\t\tlet left = 0;\n\t\tlet top = 0;\n\t\tswitch (e.key) {\n\t\t\tcase 'ArrowRight':\n\t\t\t\tleft = 5;\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowLeft':\n\t\t\t\tleft = -5;\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowDown':\n\t\t\t\ttop = 5;\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowUp':\n\t\t\t\ttop = -5;\n\t\t\t\tbreak;\n\t\t\tcase 'Home':\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.resetPosition();\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\n\t\te.preventDefault();\n\t\tthis.move(left * step, top * step);\n\t};\n\n\tpublic static defaultOptions: Required<DraggableOptions> = {\n\t\texcludedElements: [],\n\t\texcludeFocusable: true,\n\n\t\tonDrag: noop,\n\t\tonGrab: noop,\n\t\tonMove: noop,\n\t\tonRelease: noop,\n\t};\n\n\tpublic static makeDraggable({ el, keyboardEl, ...options }: DraggableOptions & {\n\t\tel: HTMLElement;\n\t\tkeyboardEl: HTMLElement | null;\n\t}): Draggable {\n\t\treturn new Draggable(el, keyboardEl, options);\n\t}\n}\n\nexport const { makeDraggable } = Draggable;\n","import { ImageDetails } from '../ImageDetails';\nimport { DescriptionAttribute, createIcon, icons } from '../../utilities';\nimport { makeDraggable } from './draggable';\n\nexport interface ImageOverlayOptions {\n\t/**\n\t * Indicates that the `Escape` key should close all `<details>`. Note that\n\t * `Escape` will always close the `details` if focus is on the `<summary>`.\n\t */\n\tcloseAllOnEscape?: boolean;\n\tdraggableClass?: string;\n\tdraggingClass?: string;\n\tresizableClass?: string;\n}\n\nconst ImageOverlayInstances = new Set<ImageOverlay>();\n\nexport class ImageOverlay {\n\tprivate enabled = false;\n\tpublic ImageDetails: ImageDetails | null = null;\n\n\tpublic static defaultOptions: Required<ImageOverlayOptions> = {\n\t\tcloseAllOnEscape: true,\n\t\tdraggingClass: 'dragging',\n\t\tdraggableClass: 'draggable',\n\t\tresizableClass: 'resizable',\n\t}\n\n\tprotected constructor(\n\t\tpublic image: HTMLImageElement,\n\t\tpublic options: Required<ImageOverlayOptions>,\n\t) {\n\t\tImageOverlayInstances.add(this);\n\t}\n\n\tpublic async enable(): Promise<void> {\n\t\tif (this.enabled) return;\n\n\t\tthis.ImageDetails = await ImageDetails.enhance(this.image, {\n\t\t\tblockName: 'overlaid',\n\t\t\tdisplaySummaryText: false,\n\t\t\tsummaryMarker: () => createIcon(icons.details),\n\t\t});\n\n\t\tif (!this.ImageDetails) return;\n\n\t\tconst { details, summary } = this.ImageDetails;\n\t\tconst { draggingClass } = this.options;\n\n\t\tmakeDraggable({\n\t\t\tel: details,\n\t\t\tkeyboardEl: summary,\n\t\t\tonDrag: () => {\n\t\t\t\tdetails.classList.add(draggingClass);\n\t\t\t},\n\t\t\tonRelease: () => {\n\t\t\t\tdetails.classList.remove(draggingClass);\n\t\t\t},\n\t\t});\n\n\t\tdetails.addEventListener('toggle', this.onToggle);\n\t\tdocument.addEventListener('keydown', this.onDocumentKeydown);\n\n\t\tthis.enabled = true;\n\t}\n\n\tpublic disable(): this {\n\t\tif (!this.enabled || !this.ImageDetails) return this;\n\t\tconst { details } = this.ImageDetails;\n\t\tdetails.removeEventListener('toggle', this.onToggle);\n\t\tdocument.removeEventListener('keydown', this.onDocumentKeydown);\n\t\tthis.enabled = false;\n\t\treturn this;\n\t}\n\n\tpublic destroy(): this {\n\t\tif (this.enabled) this.disable();\n\t\tif (this.ImageDetails) this.ImageDetails.destroy();\n\t\tImageOverlayInstances.delete(this);\n\t\treturn this;\n\t}\n\n\tpublic get isOpen(): boolean {\n\t\treturn (this.ImageDetails)\n\t\t\t? this.ImageDetails.details.open\n\t\t\t: false;\n\t}\n\n\tprivate onToggle = (): void => {\n\t\tif (!this.ImageDetails) return;\n\t\tconst { draggableClass, resizableClass } = this.options;\n\t\tconst { details, marker } = this.ImageDetails;\n\t\tif (details.open) {\n\t\t\tdetails.classList.add(draggableClass);\n\t\t\tdetails.classList.add(resizableClass);\n\t\t\tmarker.innerHTML = createIcon(icons.close).outerHTML;\n\t\t} else {\n\t\t\tdetails.classList.remove(draggableClass);\n\t\t\tdetails.classList.remove(resizableClass);\n\t\t\tdetails.removeAttribute('style');\n\t\t\tmarker.innerHTML = createIcon(icons.details).outerHTML;\n\t\t}\n\t}\n\n\tprivate onDocumentKeydown = (e: KeyboardEvent): void => {\n\t\tif (!this.ImageDetails || e.key !== 'Escape') return;\n\n\t\tconst { closeAllOnEscape } = this.options;\n\t\tconst { details } = this.ImageDetails;\n\t\tif (closeAllOnEscape) details.removeAttribute('open');\n\t}\n\n\tpublic static async enhance(\n\t\timage: HTMLImageElement,\n\t\toptions?: ImageOverlayOptions,\n\t): Promise<ImageOverlay | null> {\n\t\tconst opts = { ...ImageOverlay.defaultOptions, ...options };\n\t\tconst hasDesc = Object.values(DescriptionAttribute).some((attr) => image.getAttribute(attr));\n\t\tif (!hasDesc && !image.alt) return null;\n\t\tconst instance = new ImageOverlay(image, opts);\n\t\tawait instance.enable();\n\t\treturn instance;\n\t}\n\n\tpublic static async enhanceAll(\n\t\t{ selector = 'img', ...options }: Partial<ImageOverlayOptions & { selector?: string }> = {},\n\t): Promise<typeof ImageOverlay.instances> {\n\t\tawait Promise.all(Array.from(document.querySelectorAll<HTMLImageElement>(selector))\n\t\t\t.map(async (el) => ImageOverlay.enhance(el, options)));\n\t\treturn ImageOverlay.instances;\n\t}\n\n\tpublic static get instances(): ImageOverlay[] {\n\t\treturn Array.from(ImageOverlayInstances);\n\t}\n}\n","const ImageModalInstances = new Set<ImageModal>();\r\n\r\ninterface EnhanceAllOptions {\r\n\tselector?: string;\r\n}\r\n\r\ninterface ImageModalOptions {\r\n\tfoo?: string;\r\n}\r\n\r\n/**\r\n * TODO: implement an enhancement that displays the image and its description in\r\n * a modal dialog interface.\r\n */\r\nexport class ImageModal {\r\n\tprotected constructor(\r\n\t\tpublic image: HTMLImageElement,\r\n\t\tpublic options: Required<ImageModalOptions>,\r\n\t) {\r\n\t\tImageModalInstances.add(this);\r\n\t}\r\n\r\n\tpublic static selector = 'img';\r\n\r\n\tpublic static get instances(): ImageModal[] {\r\n\t\treturn Array.from(ImageModalInstances);\r\n\t}\r\n\r\n\tpublic static async enhance(\r\n\t\timage: HTMLImageElement,\r\n\t\toptions?: Partial<ImageModal['options']>,\r\n\t): Promise<ImageModal | null> {\r\n\t\tconst opts = {\r\n\t\t\t...ImageModal.defaultOptions,\r\n\t\t\t...options,\r\n\t\t};\r\n\t\tconst hasDesc = Object.values(DescriptionAttribute).some((attr) => image.getAttribute(attr));\r\n\t\tif (!hasDesc && !image.alt) return null;\r\n\t\tconst instance = new ImageModal(image, opts);\r\n\t\tawait instance.enable();\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tpublic static async enhanceAll({\r\n\t\tselector = ImageModal.selector,\r\n\t\t...options\r\n\t}: EnhanceAllOptions = {}): Promise<typeof ImageModal.instances> {\r\n\t\tawait Promise.all(Array.from(document.querySelectorAll<HTMLImageElement>(selector))\r\n\t\t\t.map(async (el) => ImageModal.enhance(el, options)));\r\n\t\treturn ImageModal.instances;\r\n\t}\r\n\r\n\tpublic static defaultOptions: Required<ImageModalOptions> = {\r\n\t\tfoo: '',\r\n\t}\r\n}\r\n","export * from './enhancements/ImageDetails';\nexport * from './enhancements/ImageOverlay';\nexport * from './enhancements/ImageModal';\nexport * from './utilities';\n","import { ImageOverlay } from '../../src';\n\nImageOverlay.enhanceAll().then(console.log);\n"]}